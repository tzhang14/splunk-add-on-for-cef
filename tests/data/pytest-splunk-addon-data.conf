#
# ################################################################################
#
#  Copyright (C) 2018 Splunk Inc.
#
#  You should have received a copy of the Splunk Software Licese agreement
#  along with TA-cef-for-splunk.  If not, see:
#  <http://www.splunk.com/en_us/legal/splunk-software-license-agreement.html>
#
# #################################################################################
#
[cef_syslog.sample]
sourcetype=cef
interval = 3600
input_type = syslog_tcp
host_type = event
sourcetype_to_search = cef
sample_count = 6
breaker = ([\r\n]+)
timestamp_type = event

token.0.token = ((?:\w{3}\s+\d{1,2}\s+\d{2}:\d{2}:\d{2})|(?:\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})|(?:\d{4}\/\d{2}\/\d{2}\s+\d{2}:\d{2}:\d{2})|(?:\d{1,2}\/\d{1,2}\/\d{4}\s+\d{1,2}:\d{1,2}\s+\w{2}))
token.0.replacementType = timestamp
token.0.replacement = %b %d %H:%M:%S
token.0.field = _time

token.1.token = dstIP=(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})
token.1.replacementType = random
token.1.replacement = ipv4

token.2.token = srcIP=(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})
token.2.replacementType = random
token.2.replacement = ipv4

token.3.token = \s+dst=(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})
token.3.replacementType = random
token.3.replacement = dest['ipv4']
#token.3.field = dest

token.4.token = ##src##
token.4.replacementType = random
token.4.replacement = src['ipv4']
token.4.field = src

token.5.token = username=([^,]*)
token.5.replacementType = random
token.5.replacement = user['name']

token.6.token = ##duser##
token.6.replacementType = random
token.6.replacement = user['name']
token.6.field = user

token.7.token = ##suser##
token.7.replacementType = random
token.7.replacement = user['name']

token.8.token = ##host##
token.8.replacementType = random
token.8.replacement = host["host"]
token.8.field = host

token.9.token = rt=((?:\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}:\d{2}:\d{2})|(?:\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})|(?:\d{4}\/\d{2}\/\d{2}\s+\d{2}:\d{2}:\d{2})|(?:\d{2}\s+\w{3,9}\s+\d{4}\s+\d{2}:\d{2}:\d{2}))
token.9.replacementType = timestamp
token.9.replacement = %b %d %Y %H:%M:%S

token.10.token = (?:rt|start|end)=(\d+)
token.10.replacementType = timestamp
token.10.replacement = %s

token.11.token = ##dhost##
token.11.replacementType = random
token.11.replacement = dest["host"]
token.11.field = dest
